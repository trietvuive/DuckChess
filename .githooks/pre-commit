#!/bin/sh

set -e
cd "$(git rev-parse --show-toplevel)"

echo "Running cargo fmt..."
cargo fmt --all
# Re-stage any files that fmt changed so the commit includes formatted code.
git add -u

echo "Running cargo lint (clippy)..."
cargo lint || {
    echo "Commit aborted: fix clippy warnings above (cargo lint)"
    exit 1
}

exit 0
